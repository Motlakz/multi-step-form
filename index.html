<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="css/styles.css">
    <title>Multi Step Form</title>
    <link rel="icon" href="images/favicon.ico" type="image/x-icon" sizes="any">
    <script src="https://kit.fontawesome.com/b8612dc57b.js" crossorigin="anonymous"></script>
</head>
<body>
    <main class="container">
        <form action="">
            <legend>Register</legend>
            <label for="name">Full Names</label>
            <input type="text" name="name" id="" placeholder="Julie Sanderson" required />
            
            <label for="email">Email</label>
            <input type="email" name="email" id="" placeholder="example@hotmail.org" required />
            <button type="button" class="continue" data-index="0">Continue</button>
        </form>
        <form action="" class="question second-form">
            <legend>Which topics are you interested in?</legend>
                <label class="custom-radio">
                    <input type="radio" name="programming" value="Software Development">
                    <span class="radio-label">Software Development</span>
                </label>
                <label class="custom-radio">
                    <input type="radio" name="programming" value="User Experience">
                    <span class="radio-label">User Experience</span>
                </label>
                <label class="custom-radio">
                    <input type="radio" name="programming" value="graphic Design">
                    <span class="radio-label">Graphic Design</span>
                </label>
            <button type="button" class="continue" data-index="1">Continue</button>
        </form>
        <form action="" class="summary">
            <legend>Summary</legend>
            <span class="name">Full Names: <p id="name"></p></span>
            <span class="email">Email: <p id="email"></p></span>
            <ul>
                <p>Topics:</p>
                <li>User Experience</li>
                <li>Graphic Desgin</li>
            </ul>
            <button type="button" id="confirmButton">Confirm</button>

            <div id="success-message" style="display: none;">
            </div>
        </form>
        <div class="steps">
            <span class="step"></span>
            <span class="step"></span>
            <span class="step"></span>
        </div>
        <div class="dots">
            <i class="fas fa-circle form1"></i><i class="fas fa-circle form2"></i><i class="fas fa-circle form3"></i>
        </div>
    </main>
    <script>
        const forms = document.querySelectorAll('form');
        const continueButtons = document.querySelectorAll('.continue');
        const dots = document.querySelectorAll('.dots i');
        const steps = document.querySelectorAll('.steps .step');

        const nameInput = document.querySelector('input[name="name"]');
        const emailInput = document.querySelector('input[name="email"]');
        const nameSummary = document.querySelector('.summary .name p');
        const emailSummary = document.querySelector('.summary .email p');

        let currentFormIndex = 0;

        function showForm(index) {
            forms.forEach((form, i) => {
                if (i === index) {
                    form.style.display = 'grid';
                    dots[i].classList.add('active');
                } else {
                    form.style.display = 'none';
                    dots[i].classList.remove('active');
                }
            });
            updateSteps(index);
        }

        function updateSteps(index) {
            steps.forEach((step, i) => {
                if (i === index) {
                    step.textContent = `Step ${i + 1} of ${forms.length}`;
                } else {
                    step.textContent = '';
                }
            });
        }

        showForm(currentFormIndex);

        dots.forEach((dot, index) => {
            dot.addEventListener('click', () => {
                showForm(index);
                currentFormIndex = index;
            });
        });

        continueButtons.forEach((button, index) => {
            button.addEventListener('click', () => {
                const formIndex = button.getAttribute('data-index'); // Get the data-index attribute

                if (validateForm(formIndex)) {
                    if (currentFormIndex < forms.length - 1) {
                        // Check if it's the second form and a radio button is selected
                        if (formIndex === "1" && !isRadioButtonSelected()) {
                            alert('Please select a programming topic');
                            return;
                        }

                        currentFormIndex++;
                        showForm(currentFormIndex);
                    }
                    // Check if it's the final form and update the summary
                    if (currentFormIndex === forms.length - 1) {
                        const nameValue = nameInput.value;
                        const emailValue = emailInput.value;
                        const confirm = document.getElementById('confirmButton');
                        nameSummary.textContent = `Full Names: ${nameValue}`;
                        emailSummary.textContent = `Email: ${emailValue}`;
                        confirm.addEventListener('click', () => {
                            alert("âœ… Success!");
                        })
                    }
                }
            });
        });

        function isRadioButtonSelected() {
            // Check if any radio button is selected within the second form
            const secondForm = document.querySelector('.second-form');
            const radioButtons = secondForm.querySelectorAll('input[name="programming"]');
            let isRadioButtonSelected = false;

            radioButtons.forEach((radio) => {
                if (radio.checked) {
                    isRadioButtonSelected = true;
                }
            });

            return isRadioButtonSelected;
        }

        function validateForm(formIndex) {
            const name = nameInput.value.trim();
            const email = emailInput.value.trim();

            if (name === "" && email === "") {
                alert('Cannot submit blank form');
                return false;
            }

            if (name === "") {
                alert('Name cannot be blank');
                nameInput.classList.add('error-border');
                return false;
            }

            if (email === "") {
                alert('Email cannot be blank');
                emailInput.classList.add('error-border');
                return false;
            }

            const emailRegex = /^[A-Za-z0-9._%-]+@[A-Za-z0-9.-]+\.[A-Za-z]{2,4}$/;

            if (!emailRegex.test(email)) {
                alert('Invalid email format');
                emailInput.classList.add('error-border');
                return false;
            }

            if (formIndex === "1") {
                const secondForm = document.querySelector('.second-form');
                const radioButtons = secondForm.querySelectorAll('input[name="programming"]');
                
                if (![...radioButtons].some((radio) => radio.checked)) {
                    alert('Please select a programming topic');
                    return false;
                }
            }

            return true;
        }
        // removes red border on focus
        nameInput.addEventListener('focus', () => {
            nameInput.classList.remove('error-border');
        });

        emailInput.addEventListener('focus', () => {
            emailInput.classList.remove('error-border');
        });

    </script>
</body>
</html>